<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pomodoro Timer (Test 25s/5s)</title>
<style>
  body { margin:0; font-family: sans-serif; background:#0b0b0b; color:#fff; display:grid; place-items:center; min-height:100vh; }
  .app { width:300px; background:#181818; border-radius:12px; padding:20px; text-align:center; }
  .time { font-size:48px; margin:20px 0; }
  .btns button { margin:5px; padding:10px 16px; border:none; border-radius:8px; cursor:pointer; }
  .start { background:#2f6df6; color:#fff; }
  .stop { background:#d9534f; color:#fff; }
  .reset { background:#5bc0de; color:#fff; }
  /* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¯åˆæœŸçŠ¶æ…‹ã§éè¡¨ç¤º */
  #overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.85);
             color:white; font-size:2em; align-items:center; justify-content:center; z-index:9999; }
  #cycle { font-size: 14px; color: #9ad; margin-bottom: 14px; }
</style>
</head>
<body>
<div class="app">
  <h1>Pomodoro Timer</h1>
  <div id="cycle">25åˆ†é›†ä¸­ ğŸ”„ 5åˆ†ä¼‘æ†©</div>
  <div id="mode">ãƒ¢ãƒ¼ãƒ‰: å¾…æ©Ÿ</div>
  <div id="time" class="time">00:25</div>
  <div class="btns">
    <button id="startBtn" class="start">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    <button id="stopBtn" class="stop">åœæ­¢</button>
    <button id="resetBtn" class="reset">ãƒªã‚»ãƒƒãƒˆ</button>
  </div>
</div>

<div id="overlay">ğŸ‰ çµ‚äº†ï¼ ğŸ‰</div>

<audio id="bgm" src="sounds/mixkit-recline-and-chill-25.mp3" loop></audio>

<script>
(function(){
  const focusSec = 25, breakSec = 5*60;
  let remain = focusSec, timer=null, running=false, mode='focus';

  const timeEl = document.getElementById('time');
  const modeEl = document.getElementById('mode');
  const overlay = document.getElementById('overlay');

  function fmt(s){ const m=Math.floor(s/60), sec=s%60; return `${String(m).padStart(2,'0')}:${String(sec).padStart(2,'0')}`; }

  function render(){ timeEl.textContent = fmt(remain); modeEl.textContent = `ãƒ¢ãƒ¼ãƒ‰: ${mode==='focus'?'é›†ä¸­':'ä¼‘æ†©'}`; }

  function showOverlay(msg){
    overlay.textContent = msg;
    overlay.style.display = "flex";
    setTimeout(()=>{ overlay.style.display="none"; }, 5000);
  }

  function switchMode(){
    if(mode==='focus'){ 
      mode='break'; 
      remain=breakSec; 
      showOverlay("é›†ä¸­çµ‚äº†ï¼ä¼‘æ†©ã—ã¾ã—ã‚‡ã†"); 
      const bgm = document.getElementById("bgm");
      bgm.currentTime = 0;   // æ¯å›é ­ã‹ã‚‰å†ç”Ÿ
      bgm.play();            // ä¼‘æ†©é–‹å§‹ã¨åŒæ™‚ã«å†ç”Ÿ
    } else { 
      mode='focus'; 
      remain=focusSec; 
      showOverlay("ä¼‘æ†©çµ‚äº†ï¼é›†ä¸­ã‚’å§‹ã‚ã¾ã—ã‚‡ã†"); 
      const bgm = document.getElementById("bgm");
      bgm.pause(); 
      bgm.currentTime = 0;   // é›†ä¸­ã«æˆ»ã£ãŸã‚‰åœæ­¢ï¼†ãƒªã‚»ãƒƒãƒˆ
    }
    render();
  }

  function tick(){
    if(!running) return;
    remain--; render();
    if(remain<0) switchMode();
  }

  document.getElementById('startBtn').onclick = ()=>{
    if(running) return;
    running=true; render();
    timer=setInterval(tick,1000);
    if(mode === 'break'){
      const bgm = document.getElementById("bgm");
      bgm.play();
    }
  };
  document.getElementById('stopBtn').onclick = ()=>{
    running=false; clearInterval(timer);
    const bgm = document.getElementById("bgm");
    if(mode === 'break'){ bgm.pause(); }   // ä¼‘æ†©ä¸­ãªã‚‰éŸ³ã‚‚ä¸€æ™‚åœæ­¢
  };
  document.getElementById('resetBtn').onclick = ()=>{
    running=false; clearInterval(timer);
    mode='focus'; remain=focusSec; render();
    // ãƒªã‚»ãƒƒãƒˆæ™‚ã‚‚ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã¯å¿…ãšæ¶ˆã™
    overlay.style.display="none";
    const bgm = document.getElementById("bgm");
    bgm.pause();          // ãƒªã‚»ãƒƒãƒˆæ™‚ã‚‚éŸ³å£°ã‚’æ­¢ã‚ã‚‹
    bgm.currentTime = 0;  // å†ç”Ÿä½ç½®ã‚’ãƒªã‚»ãƒƒãƒˆ
  };

  render();
})();
</script>
</body>
</html>
